{"ast":null,"code":"import $ from \"jquery\";\nimport \"smartadmin-plugins/es6/jquery-ui.min\";\n/*\n * SMARTCHAT PLUGIN ARRAYS & CONFIG\n * Dependency: js/plugin/moment/moment.min.js\n *             js/plugin/cssemotions/jquery.cssemoticons.min.js\n *             js/smart-chat-ui/smart.chat.ui.js\n * (DO NOT CHANGE)\n */\n\nvar boxList = [],\n    showList = [],\n    nameList = [];\n/*\n * Width of the chat boxes, and the gap inbetween in pixel (minus padding)\n */\n\nvar chatbox_config = {\n  width: 200,\n  gap: 35,\n  offset: 0\n};\n/*\n * SMART CHAT ENGINE\n * Copyright (c) 2013 Wen Pu\n * Modified by MyOrange\n * All modifications made are hereby copyright (c) 2014-2015 MyOrange\n */\n// TODO: implement destroy()\n\n$.widget(\"ui.chatbox\", {\n  options: {\n    id: null,\n    //id for the DOM element\n    title: null,\n    // title of the chatbox\n    user: null,\n    // can be anything associated with this chatbox\n    hidden: false,\n    offset: 0,\n    // relative to right edge of the browser window\n    width: 300,\n    // width of the chatbox\n    status: \"online\",\n    //\n    alertmsg: null,\n    alertshow: null,\n    messageSent: function messageSent(id, user, msg) {\n      // override this\n      this.boxManager.addMsg(user.first_name, msg);\n    },\n    boxClosed: function boxClosed(id) {},\n    // called when the close icon is clicked\n    boxManager: {\n      // thanks to the widget factory facility\n      // similar to http://alexsexton.com/?p=51\n      init: function init(elem) {\n        this.elem = elem;\n      },\n      addMsg: function addMsg(peer, msg) {\n        var self = this;\n        var box = self.elem.uiChatboxLog;\n        var e = document.createElement(\"div\");\n        box.append(e);\n        $(e).hide();\n        var systemMessage = false;\n\n        if (peer) {\n          var peerName = document.createElement(\"b\");\n          $(peerName).text(peer + \": \");\n          e.appendChild(peerName);\n        } else {\n          systemMessage = true;\n        }\n\n        var msgElement = document.createElement(systemMessage ? \"i\" : \"span\");\n        $(msgElement).text(msg);\n        e.appendChild(msgElement);\n        $(e).addClass(\"ui-chatbox-msg\");\n        $(e).css(\"maxWidth\", $(box).width());\n        $(e).fadeIn(); //$(e).prop( 'title', moment().calendar() ); // add dep: moment.js\n\n        $(e).find(\"span\").emoticonize(); // add dep: jquery.cssemoticons.js\n\n        self._scrollToBottom();\n\n        if (!self.elem.uiChatboxTitlebar.hasClass(\"ui-state-focus\") && !self.highlightLock) {\n          self.highlightLock = true;\n          self.highlightBox();\n        }\n      },\n      highlightBox: function highlightBox() {\n        var self = this;\n        self.elem.uiChatboxTitlebar.effect(\"highlight\", {}, 300);\n        self.elem.uiChatbox.effect(\"bounce\", {\n          times: 2\n        }, 300, function () {\n          self.highlightLock = false;\n\n          self._scrollToBottom();\n        });\n      },\n      toggleBox: function toggleBox() {\n        this.elem.uiChatbox.toggle();\n      },\n      _scrollToBottom: function _scrollToBottom() {\n        var box = this.elem.uiChatboxLog;\n        box.scrollTop(box.get(0).scrollHeight);\n      }\n    }\n  },\n  toggleContent: function toggleContent(event) {\n    this.uiChatboxContent.toggle();\n\n    if (this.uiChatboxContent.is(\":visible\")) {\n      this.uiChatboxInputBox.focus();\n    }\n  },\n  widget: function widget() {\n    return this.uiChatbox;\n  },\n  _create: function _create() {\n    var self = this,\n        options = self.options,\n        title = options.title || \"No Title\",\n        // chatbox\n    uiChatbox = (self.uiChatbox = $(\"<div></div>\")).appendTo(document.body).addClass(\"ui-widget \" + //'ui-corner-top ' +\n    \"ui-chatbox\").attr(\"outline\", 0).focusin(function () {\n      // ui-state-highlight is not really helpful here\n      //self.uiChatbox.removeClass('ui-state-highlight');\n      self.uiChatboxTitlebar.addClass(\"ui-state-focus\");\n    }).focusout(function () {\n      self.uiChatboxTitlebar.removeClass(\"ui-state-focus\");\n    }),\n        // titlebar\n    uiChatboxTitlebar = (self.uiChatboxTitlebar = $(\"<div></div>\")).addClass(\"ui-widget-header \" + //'ui-corner-top ' +\n    \"ui-chatbox-titlebar \" + self.options.status + \" ui-dialog-header\" // take advantage of dialog header style\n    ).click(function (event) {\n      self.toggleContent(event);\n    }).appendTo(uiChatbox),\n        uiChatboxTitle = (self.uiChatboxTitle = $(\"<span></span>\")).html(title).appendTo(uiChatboxTitlebar),\n        uiChatboxTitlebarClose = (self.uiChatboxTitlebarClose = $('<a href=\"#\" rel=\"tooltip\" data-placement=\"top\" data-original-title=\"Hide\"></a>')).addClass( //'ui-corner-all ' +\n    \"ui-chatbox-icon \").attr(\"role\", \"button\").hover(function () {\n      uiChatboxTitlebarClose.addClass(\"ui-state-hover\");\n    }, function () {\n      uiChatboxTitlebarClose.removeClass(\"ui-state-hover\");\n    }).click(function (event) {\n      uiChatbox.hide();\n      self.options.boxClosed(self.options.id);\n      return false;\n    }).appendTo(uiChatboxTitlebar),\n        uiChatboxTitlebarCloseText = $(\"<i></i>\").addClass(\"fa fa-times\").appendTo(uiChatboxTitlebarClose),\n        uiChatboxTitlebarMinimize = (self.uiChatboxTitlebarMinimize = $('<a href=\"#\" rel=\"tooltip\" data-placement=\"top\" data-original-title=\"Minimize\"></a>')).addClass( //'ui-corner-all ' +\n    \"ui-chatbox-icon\").attr(\"role\", \"button\").hover(function () {\n      uiChatboxTitlebarMinimize.addClass(\"ui-state-hover\");\n    }, function () {\n      uiChatboxTitlebarMinimize.removeClass(\"ui-state-hover\");\n    }).click(function (event) {\n      self.toggleContent(event);\n      return false;\n    }).appendTo(uiChatboxTitlebar),\n        uiChatboxTitlebarMinimizeText = $(\"<i></i>\").addClass(\"fa fa-minus\").appendTo(uiChatboxTitlebarMinimize),\n        // content\n    uiChatboxContent = (self.uiChatboxContent = $('<div class=\"' + self.options.alertshow + '\"><span class=\"alert-msg\">' + self.options.alertmsg + \"</span></div>\")).addClass(\"ui-widget-content ui-chatbox-content \").appendTo(uiChatbox),\n        uiChatboxLog = (self.uiChatboxLog = self.element).addClass(\"ui-widget-content ui-chatbox-log custom-scroll\").appendTo(uiChatboxContent),\n        uiChatboxInput = (self.uiChatboxInput = $(\"<div></div>\")).addClass(\"ui-widget-content ui-chatbox-input\").click(function (event) {// anything?\n    }).appendTo(uiChatboxContent),\n        uiChatboxInputBox = (self.uiChatboxInputBox = $(\"<textarea></textarea>\")).addClass(\"ui-widget-content ui-chatbox-input-box \").appendTo(uiChatboxInput).keydown(function (event) {\n      if (event.keyCode && event.keyCode === $.ui.keyCode.ENTER) {\n        var msg = $.trim($(this).val());\n\n        if (msg.length > 0) {\n          self.options.messageSent(self.options.id, self.options.user, msg);\n        }\n\n        $(this).val(\"\");\n        return false;\n      }\n    }).focusin(function () {\n      uiChatboxInputBox.addClass(\"ui-chatbox-input-focus\");\n      var box = $(this).parent().prev();\n      box.scrollTop(box.get(0).scrollHeight);\n    }).focusout(function () {\n      uiChatboxInputBox.removeClass(\"ui-chatbox-input-focus\");\n    }); // disable selection\n\n    uiChatboxTitlebar.find(\"*\").add(uiChatboxTitlebar).disableSelection(); // switch focus to input box when whatever clicked\n\n    uiChatboxContent.children().click(function () {\n      // click on any children, set focus on input box\n      self.uiChatboxInputBox.focus();\n    });\n\n    self._setWidth(self.options.width);\n\n    self._position(self.options.offset);\n\n    self.options.boxManager.init(self);\n\n    if (!self.options.hidden) {\n      uiChatbox.show();\n    }\n\n    $(\".ui-chatbox [rel=tooltip]\").tooltip(); //console.log(\"tooltip created\");\n\n    return {\n      uiChatboxTitle: uiChatboxTitle,\n      uiChatboxTitlebarCloseText: uiChatboxTitlebarCloseText,\n      uiChatboxTitlebarMinimizeText: uiChatboxTitlebarMinimizeText,\n      uiChatboxLog: uiChatboxLog\n    };\n  },\n  _setOption: function _setOption(option, value) {\n    if (value !== null) {\n      switch (option) {\n        case \"hidden\":\n          if (value) this.uiChatbox.hide();else this.uiChatbox.show();\n          break;\n\n        case \"offset\":\n          this._position(value);\n\n          break;\n\n        case \"width\":\n          this._setWidth(value);\n\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    $.Widget.prototype._setOption.apply(this, arguments);\n  },\n  _setWidth: function _setWidth(width) {\n    this.uiChatbox.width(width + 28 + \"px\"); //this.uiChatboxTitlebar.width((width + 28) + \"px\");\n    //this.uiChatboxLog.width(width + \"px\");\n    // this.uiChatboxInput.css(\"maxWidth\", width + \"px\");\n    // padding:2, boarder:2, margin:5\n\n    this.uiChatboxInputBox.css(\"width\", width + 18 + \"px\");\n  },\n  _position: function _position(offset) {\n    this.uiChatbox.css(\"right\", offset);\n  }\n});\n/*\n * jQuery CSSEmoticons plugin 0.2.9\n *\n * Copyright (c) 2010 Steve Schwartz (JangoSteve)\n *\n * Dual licensed under the MIT and GPL licenses:\n *   http://www.opensource.org/licenses/mit-license.php\n *   http://www.gnu.org/licenses/gpl.html\n *\n * Date: Sun Oct 22 1:00:00 2010 -0500\n */\n\n$.fn.emoticonize = function (options) {\n  var opts = $.extend({}, $.fn.emoticonize.defaults, options);\n  var escapeCharacters = [\")\", \"(\", \"*\", \"[\", \"]\", \"{\", \"}\", \"|\", \"^\", \"<\", \">\", \"\\\\\", \"?\", \"+\", \"=\", \".\"];\n  var threeCharacterEmoticons = [// really weird bug if you have :{ and then have :{) in the same container anywhere *after* :{ then :{ doesn't get matched, e.g. :] :{ :) :{) :) :-) will match everything except :{\n  //  But if you take out the :{) or even just move :{ to the right of :{) then everything works fine. This has something to do with the preMatch string below I think, because\n  //  it'll work again if you set preMatch equal to '()'\n  //  So for now, we'll just remove :{) from the emoticons, because who actually uses this mustache man anyway?\n  // \":{)\",\n  \":-)\", \":o)\", \":c)\", \":^)\", \":-D\", \":-(\", \":-9\", \";-)\", \":-P\", \":-p\", \":-Þ\", \":-b\", \":-O\", \":-/\", \":-X\", \":-#\", \":'(\", \"B-)\", \"8-)\", \";*(\", \":-*\", \":-\\\\\", \"?-)\", // <== This is my own invention, it's a smiling pirate (with an eye-patch)!\n  // and the twoCharacterEmoticons from below, but with a space inserted\n  \": )\", \": ]\", \"= ]\", \"= )\", \"8 )\", \": }\", \": D\", \"8 D\", \"X D\", \"x D\", \"= D\", \": (\", \": [\", \": {\", \"= (\", \"; )\", \"; ]\", \"; D\", \": P\", \": p\", \"= P\", \"= p\", \": b\", \": Þ\", \": O\", \"8 O\", \": /\", \"= /\", \": S\", \": #\", \": X\", \"B )\", \": |\", \": \\\\\", \"= \\\\\", \": *\", \": &gt;\", \": &lt;\" //, \"* )\"\n  ];\n  var twoCharacterEmoticons = [// separate these out so that we can add a letter-spacing between the characters for better proportions\n  \":)\", \":]\", \"=]\", \"=)\", \"8)\", \":}\", \":D\", \":(\", \":[\", \":{\", \"=(\", \";)\", \";]\", \";D\", \":P\", \":p\", \"=P\", \"=p\", \":b\", \":Þ\", \":O\", \":/\", \"=/\", \":S\", \":#\", \":X\", \"B)\", \":|\", \":\\\\\", \"=\\\\\", \":*\", \":&gt;\", \":&lt;\" //, \"*)\"\n  ];\n  var specialEmoticons = {\n    // emoticons to be treated with a special class, hash specifies the additional class to add, along with standard css-emoticon class\n    \"&gt;:)\": {\n      cssClass: \"red-emoticon small-emoticon spaced-emoticon\"\n    },\n    \"&gt;;)\": {\n      cssClass: \"red-emoticon small-emoticon spaced-emoticon\"\n    },\n    \"&gt;:(\": {\n      cssClass: \"red-emoticon small-emoticon spaced-emoticon\"\n    },\n    \"&gt;: )\": {\n      cssClass: \"red-emoticon small-emoticon\"\n    },\n    \"&gt;; )\": {\n      cssClass: \"red-emoticon small-emoticon\"\n    },\n    \"&gt;: (\": {\n      cssClass: \"red-emoticon small-emoticon\"\n    },\n    \";(\": {\n      cssClass: \"red-emoticon spaced-emoticon\"\n    },\n    \"&lt;3\": {\n      cssClass: \"pink-emoticon counter-rotated\"\n    },\n    O_O: {\n      cssClass: \"no-rotate\"\n    },\n    o_o: {\n      cssClass: \"no-rotate\"\n    },\n    \"0_o\": {\n      cssClass: \"no-rotate\"\n    },\n    O_o: {\n      cssClass: \"no-rotate\"\n    },\n    T_T: {\n      cssClass: \"no-rotate\"\n    },\n    \"^_^\": {\n      cssClass: \"no-rotate\"\n    },\n    \"O:)\": {\n      cssClass: \"small-emoticon spaced-emoticon\"\n    },\n    \"O: )\": {\n      cssClass: \"small-emoticon\"\n    },\n    \"8D\": {\n      cssClass: \"small-emoticon spaced-emoticon\"\n    },\n    XD: {\n      cssClass: \"small-emoticon spaced-emoticon\"\n    },\n    xD: {\n      cssClass: \"small-emoticon spaced-emoticon\"\n    },\n    \"=D\": {\n      cssClass: \"small-emoticon spaced-emoticon\"\n    },\n    \"8O\": {\n      cssClass: \"small-emoticon spaced-emoticon\"\n    },\n    \"[+=..]\": {\n      cssClass: \"no-rotate nintendo-controller\"\n    } //\"OwO\":  { cssClass: \"no-rotate\" }, // these emoticons overflow and look weird even if they're made even smaller, could probably fix this with some more css trickery\n    //\"O-O\":  { cssClass: \"no-rotate\" },\n    //\"O=)\":    { cssClass: \"small-emoticon\" }\n\n  };\n  var specialRegex = new RegExp(\"(\\\\\" + escapeCharacters.join(\"|\\\\\") + \")\", \"g\"); // One of these characters must be present before the matched emoticon, or the matched emoticon must be the first character in the container HTML\n  //  This is to ensure that the characters in the middle of HTML properties or URLs are not matched as emoticons\n  //  Below matches ^ (first character in container HTML), \\s (whitespace like space or tab), or \\0 (NULL character)\n  // (<\\\\S+.*>) matches <\\\\S+.*> (matches an HTML tag like <span> or <div>), but haven't quite gotten it working yet, need to push this fix now\n\n  var preMatch = \"(^|[\\\\s\\\\0])\";\n\n  for (var i = threeCharacterEmoticons.length - 1; i >= 0; --i) {\n    threeCharacterEmoticons[i] = threeCharacterEmoticons[i].replace(specialRegex, \"\\\\$1\"); // threeCharacterEmoticons[i] = new RegExp((preMatch + '(' + threeCharacterEmoticons[i] + ')'), 'g');\n  }\n\n  for (var j = twoCharacterEmoticons.length - 1; j >= 0; --j) {\n    twoCharacterEmoticons[j] = twoCharacterEmoticons[j].replace(specialRegex, \"\\\\$1\"); // twoCharacterEmoticons[i] = new RegExp(preMatch + '(' + twoCharacterEmoticons[i] + ')', 'g');\n  }\n\n  for (var emoticon in specialEmoticons) {\n    specialEmoticons[emoticon].regexp = emoticon.replace(specialRegex, \"\\\\$1\");\n    specialEmoticons[emoticon].regexp = new RegExp(preMatch + \"(\" + specialEmoticons[emoticon].regexp + \")\", \"g\");\n  }\n\n  var exclude = \"span.css-emoticon\";\n\n  if (opts.exclude) {\n    exclude += \",\" + opts.exclude;\n  }\n\n  var excludeArray = exclude.split(\",\");\n  return this.not(exclude).each(function () {\n    var container = $(this);\n    var cssClass = \"css-emoticon\";\n\n    if (opts.animate) {\n      cssClass += \" un-transformed-emoticon animated-emoticon\";\n    }\n\n    for (var emoticon in specialEmoticons) {\n      var specialCssClass = cssClass + \" \" + specialEmoticons[emoticon].cssClass;\n      container.html(container.html().replace(specialEmoticons[emoticon].regexp, \"$1<span class='\" + specialCssClass + \"'>$2</span>\"));\n    }\n\n    $(threeCharacterEmoticons).each(function () {\n      container.html(container.html().replace(this, \"$1<span class='\" + cssClass + \"'>$2</span>\"));\n    });\n    $(twoCharacterEmoticons).each(function () {\n      container.html(container.html().replace(this, \"$1<span class='\" + cssClass + \" spaced-emoticon'>$2</span>\"));\n    }); // fix emoticons that got matched more then once (where one emoticon is a subset of another emoticon), and thus got nested spans\n\n    $.each(excludeArray, function (index, item) {\n      container.find($.trim(item) + \" span.css-emoticon\").each(function () {\n        $(this).replaceWith($(this).text());\n      });\n    });\n\n    if (opts.animate) {\n      setTimeout(function () {\n        $(\".un-transformed-emoticon\").removeClass(\"un-transformed-emoticon\");\n      }, opts.delay);\n    }\n  });\n};\n\n$.fn.unemoticonize = function (options) {\n  var opts = $.extend({}, $.fn.emoticonize.defaults, options);\n  return this.each(function () {\n    var container = $(this);\n    container.find(\"span.css-emoticon\").each(function () {\n      // add delay equal to animate speed if animate is not false\n      var span = $(this);\n\n      if (opts.animate) {\n        span.addClass(\"un-transformed-emoticon\");\n        setTimeout(function () {\n          span.replaceWith(span.text());\n        }, opts.delay);\n      } else {\n        span.replaceWith(span.text());\n      }\n    });\n  });\n};\n\n$.fn.emoticonize.defaults = {\n  animate: true,\n  delay: 500,\n  exclude: \"pre,code,.no-emoticons\"\n};\n\nvar init = function init(options) {\n  $.extend(chatbox_config, options);\n};\n\nvar delBox = function delBox(id) {// TODO\n};\n\nvar getNextOffset = function getNextOffset() {\n  return (chatbox_config.width + chatbox_config.gap) * showList.length;\n};\n\nvar boxClosedCallback = function boxClosedCallback(id) {\n  // close button in the titlebar is clicked\n  var idx = showList.indexOf(id);\n\n  if (idx !== -1) {\n    showList.splice(idx, 1);\n    var diff = chatbox_config.width + chatbox_config.gap;\n\n    for (var i = idx; i < showList.length; i++) {\n      chatbox_config.offset = $(\"#\" + showList[i]).chatbox(\"option\", \"offset\");\n      $(\"#\" + showList[i]).chatbox(\"option\", \"offset\", chatbox_config.offset - diff);\n    }\n  } else {\n    alert(\"NOTE: Id missing from array: \" + id);\n  }\n}; // caller should guarantee the uniqueness of id\n\n\nvar addBox = function addBox(id, user, name) {\n  var idx1 = showList.indexOf(id);\n  var idx2 = boxList.indexOf(id);\n\n  if (idx1 !== -1) {// found one in show box, do nothing\n  } else if (idx2 !== -1) {\n    // exists, but hidden\n    // show it and put it back to showList\n    $(\"#\" + id).chatbox(\"option\", \"offset\", getNextOffset());\n    var manager = $(\"#\" + id).chatbox(\"option\", \"boxManager\");\n    manager.toggleBox();\n    showList.push(id);\n  } else {\n    var el = document.createElement(\"div\");\n    el.setAttribute(\"id\", id);\n    $(el).chatbox({\n      id: id,\n      user: user,\n      title: '<i title=\"' + user.status + '\"></i>' + user.first_name + \" \" + user.last_name,\n      hidden: false,\n      offset: getNextOffset(),\n      width: chatbox_config.width,\n      status: user.status,\n      alertmsg: user.alertmsg,\n      alertshow: user.alertshow,\n      messageSent: dispatch,\n      boxClosed: boxClosedCallback\n    });\n    boxList.push(id);\n    showList.push(id);\n    nameList.push(user.first_name);\n  }\n}; // var messageSentCallback = function (id, user, msg) {\n//   var idx = boxList.indexOf(id);\n//   // chatbox_config.messageSent(nameList[idx], msg);\n// };\n// not used in demo\n\n\nvar dispatch = function dispatch(id, user, msg) {\n  //$(\"#log\").append(\"<i>\" + moment().calendar() + \"</i> you said to <b>\" + user.first_name + \" \" + user.last_name + \":</b> \" + msg + \"<br/>\");\n  if ($(\"#chatlog\").length) {\n    $(\"#chatlog\").append(\"You said to <b>\" + user.first_name + \" \" + user.last_name + \":</b> \" + msg + \"<br/>\").effect(\"highlight\", {}, 500);\n  }\n\n  $(\"#\" + id).chatbox(\"option\", \"boxManager\").addMsg(\"Me\", msg);\n};\n\nexport var ChatBoxes = {\n  init: init,\n  addBox: addBox,\n  delBox: delBox,\n  dispatch: dispatch\n};","map":{"version":3,"sources":["/opt/lampp/htdocs/reactApp/React_16.x/src/common/chat/lib/ChatBoxes.js"],"names":["$","boxList","showList","nameList","chatbox_config","width","gap","offset","widget","options","id","title","user","hidden","status","alertmsg","alertshow","messageSent","msg","boxManager","addMsg","first_name","boxClosed","init","elem","peer","self","box","uiChatboxLog","e","document","createElement","append","hide","systemMessage","peerName","text","appendChild","msgElement","addClass","css","fadeIn","find","emoticonize","_scrollToBottom","uiChatboxTitlebar","hasClass","highlightLock","highlightBox","effect","uiChatbox","times","toggleBox","toggle","scrollTop","get","scrollHeight","toggleContent","event","uiChatboxContent","is","uiChatboxInputBox","focus","_create","appendTo","body","attr","focusin","focusout","removeClass","click","uiChatboxTitle","html","uiChatboxTitlebarClose","hover","uiChatboxTitlebarCloseText","uiChatboxTitlebarMinimize","uiChatboxTitlebarMinimizeText","element","uiChatboxInput","keydown","keyCode","ui","ENTER","trim","val","length","parent","prev","add","disableSelection","children","_setWidth","_position","show","tooltip","_setOption","option","value","Widget","prototype","apply","arguments","fn","opts","extend","defaults","escapeCharacters","threeCharacterEmoticons","twoCharacterEmoticons","specialEmoticons","cssClass","O_O","o_o","O_o","T_T","XD","xD","specialRegex","RegExp","join","preMatch","i","replace","j","emoticon","regexp","exclude","excludeArray","split","not","each","container","animate","specialCssClass","index","item","replaceWith","setTimeout","delay","unemoticonize","span","delBox","getNextOffset","boxClosedCallback","idx","indexOf","splice","diff","chatbox","alert","addBox","name","idx1","idx2","manager","push","el","setAttribute","last_name","dispatch","ChatBoxes"],"mappings":"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","sourcesContent":["import $ from \"jquery\";\nimport \"smartadmin-plugins/es6/jquery-ui.min\";\n/*\n * SMARTCHAT PLUGIN ARRAYS & CONFIG\n * Dependency: js/plugin/moment/moment.min.js\n *             js/plugin/cssemotions/jquery.cssemoticons.min.js\n *             js/smart-chat-ui/smart.chat.ui.js\n * (DO NOT CHANGE)\n */\nvar boxList = [],\n  showList = [],\n  nameList = [];\n/*\n * Width of the chat boxes, and the gap inbetween in pixel (minus padding)\n */\nvar chatbox_config = {\n  width: 200,\n  gap: 35,\n  offset: 0\n};\n\n/*\n * SMART CHAT ENGINE\n * Copyright (c) 2013 Wen Pu\n * Modified by MyOrange\n * All modifications made are hereby copyright (c) 2014-2015 MyOrange\n */\n\n// TODO: implement destroy()\n\n$.widget(\"ui.chatbox\", {\n  options: {\n    id: null, //id for the DOM element\n    title: null, // title of the chatbox\n    user: null, // can be anything associated with this chatbox\n    hidden: false,\n    offset: 0, // relative to right edge of the browser window\n    width: 300, // width of the chatbox\n    status: \"online\", //\n    alertmsg: null,\n    alertshow: null,\n    messageSent: function(id, user, msg) {\n      // override this\n      this.boxManager.addMsg(user.first_name, msg);\n    },\n    boxClosed: function(id) {}, // called when the close icon is clicked\n    boxManager: {\n      // thanks to the widget factory facility\n      // similar to http://alexsexton.com/?p=51\n      init: function(elem) {\n        this.elem = elem;\n      },\n      addMsg: function(peer, msg) {\n        var self = this;\n        var box = self.elem.uiChatboxLog;\n        var e = document.createElement(\"div\");\n        box.append(e);\n        $(e).hide();\n\n        var systemMessage = false;\n\n        if (peer) {\n          var peerName = document.createElement(\"b\");\n          $(peerName).text(peer + \": \");\n          e.appendChild(peerName);\n        } else {\n          systemMessage = true;\n        }\n\n        var msgElement = document.createElement(systemMessage ? \"i\" : \"span\");\n        $(msgElement).text(msg);\n        e.appendChild(msgElement);\n        $(e).addClass(\"ui-chatbox-msg\");\n        $(e).css(\"maxWidth\", $(box).width());\n        $(e).fadeIn();\n        //$(e).prop( 'title', moment().calendar() ); // add dep: moment.js\n        $(e)\n          .find(\"span\")\n          .emoticonize(); // add dep: jquery.cssemoticons.js\n        self._scrollToBottom();\n\n        if (\n          !self.elem.uiChatboxTitlebar.hasClass(\"ui-state-focus\") &&\n          !self.highlightLock\n        ) {\n          self.highlightLock = true;\n          self.highlightBox();\n        }\n      },\n      highlightBox: function() {\n        var self = this;\n        self.elem.uiChatboxTitlebar.effect(\"highlight\", {}, 300);\n        self.elem.uiChatbox.effect(\"bounce\", { times: 2 }, 300, function() {\n          self.highlightLock = false;\n          self._scrollToBottom();\n        });\n      },\n      toggleBox: function() {\n        this.elem.uiChatbox.toggle();\n      },\n      _scrollToBottom: function() {\n        var box = this.elem.uiChatboxLog;\n        box.scrollTop(box.get(0).scrollHeight);\n      }\n    }\n  },\n  toggleContent: function(event) {\n    this.uiChatboxContent.toggle();\n    if (this.uiChatboxContent.is(\":visible\")) {\n      this.uiChatboxInputBox.focus();\n    }\n  },\n  widget: function() {\n    return this.uiChatbox;\n  },\n  _create: function() {\n    var self = this,\n      options = self.options,\n      title = options.title || \"No Title\",\n      // chatbox\n      uiChatbox = (self.uiChatbox = $(\"<div></div>\"))\n        .appendTo(document.body)\n        .addClass(\n          \"ui-widget \" +\n            //'ui-corner-top ' +\n            \"ui-chatbox\"\n        )\n        .attr(\"outline\", 0)\n        .focusin(function() {\n          // ui-state-highlight is not really helpful here\n          //self.uiChatbox.removeClass('ui-state-highlight');\n          self.uiChatboxTitlebar.addClass(\"ui-state-focus\");\n        })\n        .focusout(function() {\n          self.uiChatboxTitlebar.removeClass(\"ui-state-focus\");\n        }),\n      // titlebar\n      uiChatboxTitlebar = (self.uiChatboxTitlebar = $(\"<div></div>\"))\n        .addClass(\n          \"ui-widget-header \" +\n            //'ui-corner-top ' +\n            \"ui-chatbox-titlebar \" +\n            self.options.status +\n            \" ui-dialog-header\" // take advantage of dialog header style\n        )\n        .click(function(event) {\n          self.toggleContent(event);\n        })\n        .appendTo(uiChatbox),\n      uiChatboxTitle = (self.uiChatboxTitle = $(\"<span></span>\"))\n        .html(title)\n        .appendTo(uiChatboxTitlebar),\n      uiChatboxTitlebarClose = (self.uiChatboxTitlebarClose = $(\n        '<a href=\"#\" rel=\"tooltip\" data-placement=\"top\" data-original-title=\"Hide\"></a>'\n      ))\n        .addClass(\n          //'ui-corner-all ' +\n          \"ui-chatbox-icon \"\n        )\n        .attr(\"role\", \"button\")\n        .hover(\n          function() {\n            uiChatboxTitlebarClose.addClass(\"ui-state-hover\");\n          },\n          function() {\n            uiChatboxTitlebarClose.removeClass(\"ui-state-hover\");\n          }\n        )\n        .click(function(event) {\n          uiChatbox.hide();\n          self.options.boxClosed(self.options.id);\n          return false;\n        })\n        .appendTo(uiChatboxTitlebar),\n      uiChatboxTitlebarCloseText = $(\"<i></i>\")\n        .addClass(\"fa fa-times\")\n        .appendTo(uiChatboxTitlebarClose),\n      uiChatboxTitlebarMinimize = (self.uiChatboxTitlebarMinimize = $(\n        '<a href=\"#\" rel=\"tooltip\" data-placement=\"top\" data-original-title=\"Minimize\"></a>'\n      ))\n        .addClass(\n          //'ui-corner-all ' +\n          \"ui-chatbox-icon\"\n        )\n        .attr(\"role\", \"button\")\n        .hover(\n          function() {\n            uiChatboxTitlebarMinimize.addClass(\"ui-state-hover\");\n          },\n          function() {\n            uiChatboxTitlebarMinimize.removeClass(\"ui-state-hover\");\n          }\n        )\n        .click(function(event) {\n          self.toggleContent(event);\n          return false;\n        })\n        .appendTo(uiChatboxTitlebar),\n      uiChatboxTitlebarMinimizeText = $(\"<i></i>\")\n        .addClass(\"fa fa-minus\")\n        .appendTo(uiChatboxTitlebarMinimize),\n      // content\n      uiChatboxContent = (self.uiChatboxContent = $(\n        '<div class=\"' +\n          self.options.alertshow +\n          '\"><span class=\"alert-msg\">' +\n          self.options.alertmsg +\n          \"</span></div>\"\n      ))\n        .addClass(\"ui-widget-content ui-chatbox-content \")\n        .appendTo(uiChatbox),\n      uiChatboxLog = (self.uiChatboxLog = self.element)\n        .addClass(\"ui-widget-content ui-chatbox-log custom-scroll\")\n        .appendTo(uiChatboxContent),\n      uiChatboxInput = (self.uiChatboxInput = $(\"<div></div>\"))\n        .addClass(\"ui-widget-content ui-chatbox-input\")\n        .click(function(event) {\n          // anything?\n        })\n        .appendTo(uiChatboxContent),\n      uiChatboxInputBox = (self.uiChatboxInputBox = $(\"<textarea></textarea>\"))\n        .addClass(\"ui-widget-content ui-chatbox-input-box \")\n        .appendTo(uiChatboxInput)\n        .keydown(function(event) {\n          if (event.keyCode && event.keyCode === $.ui.keyCode.ENTER) {\n            var msg = $.trim($(this).val());\n            if (msg.length > 0) {\n              self.options.messageSent(self.options.id, self.options.user, msg);\n            }\n            $(this).val(\"\");\n            return false;\n          }\n        })\n        .focusin(function() {\n          uiChatboxInputBox.addClass(\"ui-chatbox-input-focus\");\n          var box = $(this)\n            .parent()\n            .prev();\n          box.scrollTop(box.get(0).scrollHeight);\n        })\n        .focusout(function() {\n          uiChatboxInputBox.removeClass(\"ui-chatbox-input-focus\");\n        });\n\n    // disable selection\n    uiChatboxTitlebar\n      .find(\"*\")\n      .add(uiChatboxTitlebar)\n      .disableSelection();\n\n    // switch focus to input box when whatever clicked\n    uiChatboxContent.children().click(function() {\n      // click on any children, set focus on input box\n      self.uiChatboxInputBox.focus();\n    });\n\n    self._setWidth(self.options.width);\n    self._position(self.options.offset);\n\n    self.options.boxManager.init(self);\n\n    if (!self.options.hidden) {\n      uiChatbox.show();\n    }\n\n    $(\".ui-chatbox [rel=tooltip]\").tooltip();\n    //console.log(\"tooltip created\");\n\n    return {\n      uiChatboxTitle,\n      uiChatboxTitlebarCloseText,\n      uiChatboxTitlebarMinimizeText,\n      uiChatboxLog\n    };\n  },\n  _setOption: function(option, value) {\n    if (value !== null) {\n      switch (option) {\n        case \"hidden\":\n          if (value) this.uiChatbox.hide();\n          else this.uiChatbox.show();\n          break;\n        case \"offset\":\n          this._position(value);\n          break;\n        case \"width\":\n          this._setWidth(value);\n          break;\n        default:\n          break;\n      }\n    }\n    $.Widget.prototype._setOption.apply(this, arguments);\n  },\n  _setWidth: function(width) {\n    this.uiChatbox.width(width + 28 + \"px\");\n    //this.uiChatboxTitlebar.width((width + 28) + \"px\");\n    //this.uiChatboxLog.width(width + \"px\");\n    // this.uiChatboxInput.css(\"maxWidth\", width + \"px\");\n    // padding:2, boarder:2, margin:5\n    this.uiChatboxInputBox.css(\"width\", width + 18 + \"px\");\n  },\n  _position: function(offset) {\n    this.uiChatbox.css(\"right\", offset);\n  }\n});\n\n/*\n * jQuery CSSEmoticons plugin 0.2.9\n *\n * Copyright (c) 2010 Steve Schwartz (JangoSteve)\n *\n * Dual licensed under the MIT and GPL licenses:\n *   http://www.opensource.org/licenses/mit-license.php\n *   http://www.gnu.org/licenses/gpl.html\n *\n * Date: Sun Oct 22 1:00:00 2010 -0500\n */\n\n$.fn.emoticonize = function(options) {\n  var opts = $.extend({}, $.fn.emoticonize.defaults, options);\n\n  var escapeCharacters = [\n    \")\",\n    \"(\",\n    \"*\",\n    \"[\",\n    \"]\",\n    \"{\",\n    \"}\",\n    \"|\",\n    \"^\",\n    \"<\",\n    \">\",\n    \"\\\\\",\n    \"?\",\n    \"+\",\n    \"=\",\n    \".\"\n  ];\n\n  var threeCharacterEmoticons = [\n    // really weird bug if you have :{ and then have :{) in the same container anywhere *after* :{ then :{ doesn't get matched, e.g. :] :{ :) :{) :) :-) will match everything except :{\n    //  But if you take out the :{) or even just move :{ to the right of :{) then everything works fine. This has something to do with the preMatch string below I think, because\n    //  it'll work again if you set preMatch equal to '()'\n    //  So for now, we'll just remove :{) from the emoticons, because who actually uses this mustache man anyway?\n    // \":{)\",\n    \":-)\",\n    \":o)\",\n    \":c)\",\n    \":^)\",\n    \":-D\",\n    \":-(\",\n    \":-9\",\n    \";-)\",\n    \":-P\",\n    \":-p\",\n    \":-Þ\",\n    \":-b\",\n    \":-O\",\n    \":-/\",\n    \":-X\",\n    \":-#\",\n    \":'(\",\n    \"B-)\",\n    \"8-)\",\n    \";*(\",\n    \":-*\",\n    \":-\\\\\",\n    \"?-)\", // <== This is my own invention, it's a smiling pirate (with an eye-patch)!\n    // and the twoCharacterEmoticons from below, but with a space inserted\n    \": )\",\n    \": ]\",\n    \"= ]\",\n    \"= )\",\n    \"8 )\",\n    \": }\",\n    \": D\",\n    \"8 D\",\n    \"X D\",\n    \"x D\",\n    \"= D\",\n    \": (\",\n    \": [\",\n    \": {\",\n    \"= (\",\n    \"; )\",\n    \"; ]\",\n    \"; D\",\n    \": P\",\n    \": p\",\n    \"= P\",\n    \"= p\",\n    \": b\",\n    \": Þ\",\n    \": O\",\n    \"8 O\",\n    \": /\",\n    \"= /\",\n    \": S\",\n    \": #\",\n    \": X\",\n    \"B )\",\n    \": |\",\n    \": \\\\\",\n    \"= \\\\\",\n    \": *\",\n    \": &gt;\",\n    \": &lt;\" //, \"* )\"\n  ];\n\n  var twoCharacterEmoticons = [\n    // separate these out so that we can add a letter-spacing between the characters for better proportions\n    \":)\",\n    \":]\",\n    \"=]\",\n    \"=)\",\n    \"8)\",\n    \":}\",\n    \":D\",\n    \":(\",\n    \":[\",\n    \":{\",\n    \"=(\",\n    \";)\",\n    \";]\",\n    \";D\",\n    \":P\",\n    \":p\",\n    \"=P\",\n    \"=p\",\n    \":b\",\n    \":Þ\",\n    \":O\",\n    \":/\",\n    \"=/\",\n    \":S\",\n    \":#\",\n    \":X\",\n    \"B)\",\n    \":|\",\n    \":\\\\\",\n    \"=\\\\\",\n    \":*\",\n    \":&gt;\",\n    \":&lt;\" //, \"*)\"\n  ];\n\n  var specialEmoticons = {\n    // emoticons to be treated with a special class, hash specifies the additional class to add, along with standard css-emoticon class\n    \"&gt;:)\": { cssClass: \"red-emoticon small-emoticon spaced-emoticon\" },\n    \"&gt;;)\": { cssClass: \"red-emoticon small-emoticon spaced-emoticon\" },\n    \"&gt;:(\": { cssClass: \"red-emoticon small-emoticon spaced-emoticon\" },\n    \"&gt;: )\": { cssClass: \"red-emoticon small-emoticon\" },\n    \"&gt;; )\": { cssClass: \"red-emoticon small-emoticon\" },\n    \"&gt;: (\": { cssClass: \"red-emoticon small-emoticon\" },\n    \";(\": { cssClass: \"red-emoticon spaced-emoticon\" },\n    \"&lt;3\": { cssClass: \"pink-emoticon counter-rotated\" },\n    O_O: { cssClass: \"no-rotate\" },\n    o_o: { cssClass: \"no-rotate\" },\n    \"0_o\": { cssClass: \"no-rotate\" },\n    O_o: { cssClass: \"no-rotate\" },\n    T_T: { cssClass: \"no-rotate\" },\n    \"^_^\": { cssClass: \"no-rotate\" },\n    \"O:)\": { cssClass: \"small-emoticon spaced-emoticon\" },\n    \"O: )\": { cssClass: \"small-emoticon\" },\n    \"8D\": { cssClass: \"small-emoticon spaced-emoticon\" },\n    XD: { cssClass: \"small-emoticon spaced-emoticon\" },\n    xD: { cssClass: \"small-emoticon spaced-emoticon\" },\n    \"=D\": { cssClass: \"small-emoticon spaced-emoticon\" },\n    \"8O\": { cssClass: \"small-emoticon spaced-emoticon\" },\n    \"[+=..]\": { cssClass: \"no-rotate nintendo-controller\" }\n    //\"OwO\":  { cssClass: \"no-rotate\" }, // these emoticons overflow and look weird even if they're made even smaller, could probably fix this with some more css trickery\n    //\"O-O\":  { cssClass: \"no-rotate\" },\n    //\"O=)\":    { cssClass: \"small-emoticon\" }\n  };\n\n  var specialRegex = new RegExp(\n    \"(\\\\\" + escapeCharacters.join(\"|\\\\\") + \")\",\n    \"g\"\n  );\n  // One of these characters must be present before the matched emoticon, or the matched emoticon must be the first character in the container HTML\n  //  This is to ensure that the characters in the middle of HTML properties or URLs are not matched as emoticons\n  //  Below matches ^ (first character in container HTML), \\s (whitespace like space or tab), or \\0 (NULL character)\n  // (<\\\\S+.*>) matches <\\\\S+.*> (matches an HTML tag like <span> or <div>), but haven't quite gotten it working yet, need to push this fix now\n  var preMatch = \"(^|[\\\\s\\\\0])\";\n\n  for (var i = threeCharacterEmoticons.length - 1; i >= 0; --i) {\n    threeCharacterEmoticons[i] = threeCharacterEmoticons[i].replace(\n      specialRegex,\n      \"\\\\$1\"\n    );\n\n    // threeCharacterEmoticons[i] = new RegExp((preMatch + '(' + threeCharacterEmoticons[i] + ')'), 'g');\n  }\n\n  for (var j = twoCharacterEmoticons.length - 1; j >= 0; --j) {\n    twoCharacterEmoticons[j] = twoCharacterEmoticons[j].replace(\n      specialRegex,\n      \"\\\\$1\"\n    );\n\n    // twoCharacterEmoticons[i] = new RegExp(preMatch + '(' + twoCharacterEmoticons[i] + ')', 'g');\n  }\n\n  for (var emoticon in specialEmoticons) {\n    specialEmoticons[emoticon].regexp = emoticon.replace(specialRegex, \"\\\\$1\");\n    specialEmoticons[emoticon].regexp = new RegExp(\n      preMatch + \"(\" + specialEmoticons[emoticon].regexp + \")\",\n      \"g\"\n    );\n  }\n\n  var exclude = \"span.css-emoticon\";\n  if (opts.exclude) {\n    exclude += \",\" + opts.exclude;\n  }\n  var excludeArray = exclude.split(\",\");\n\n  return this.not(exclude).each(function() {\n    var container = $(this);\n    var cssClass = \"css-emoticon\";\n    if (opts.animate) {\n      cssClass += \" un-transformed-emoticon animated-emoticon\";\n    }\n\n    for (var emoticon in specialEmoticons) {\n      var specialCssClass =\n        cssClass + \" \" + specialEmoticons[emoticon].cssClass;\n      container.html(\n        container\n          .html()\n          .replace(\n            specialEmoticons[emoticon].regexp,\n            \"$1<span class='\" + specialCssClass + \"'>$2</span>\"\n          )\n      );\n    }\n    $(threeCharacterEmoticons).each(function() {\n      container.html(\n        container\n          .html()\n          .replace(this, \"$1<span class='\" + cssClass + \"'>$2</span>\")\n      );\n    });\n    $(twoCharacterEmoticons).each(function() {\n      container.html(\n        container\n          .html()\n          .replace(\n            this,\n            \"$1<span class='\" + cssClass + \" spaced-emoticon'>$2</span>\"\n          )\n      );\n    });\n    // fix emoticons that got matched more then once (where one emoticon is a subset of another emoticon), and thus got nested spans\n    $.each(excludeArray, function(index, item) {\n      container.find($.trim(item) + \" span.css-emoticon\").each(function() {\n        $(this).replaceWith($(this).text());\n      });\n    });\n    if (opts.animate) {\n      setTimeout(function() {\n        $(\".un-transformed-emoticon\").removeClass(\"un-transformed-emoticon\");\n      }, opts.delay);\n    }\n  });\n};\n\n$.fn.unemoticonize = function(options) {\n  var opts = $.extend({}, $.fn.emoticonize.defaults, options);\n  return this.each(function() {\n    var container = $(this);\n    container.find(\"span.css-emoticon\").each(function() {\n      // add delay equal to animate speed if animate is not false\n      var span = $(this);\n      if (opts.animate) {\n        span.addClass(\"un-transformed-emoticon\");\n        setTimeout(function() {\n          span.replaceWith(span.text());\n        }, opts.delay);\n      } else {\n        span.replaceWith(span.text());\n      }\n    });\n  });\n};\n\n$.fn.emoticonize.defaults = {\n  animate: true,\n  delay: 500,\n  exclude: \"pre,code,.no-emoticons\"\n};\n\nvar init = function(options) {\n  $.extend(chatbox_config, options);\n};\n\nvar delBox = function(id) {\n  // TODO\n};\n\nvar getNextOffset = function() {\n  return (chatbox_config.width + chatbox_config.gap) * showList.length;\n};\n\nvar boxClosedCallback = function(id) {\n  // close button in the titlebar is clicked\n  var idx = showList.indexOf(id);\n  if (idx !== -1) {\n    showList.splice(idx, 1);\n    var diff = chatbox_config.width + chatbox_config.gap;\n    for (var i = idx; i < showList.length; i++) {\n      chatbox_config.offset = $(\"#\" + showList[i]).chatbox(\"option\", \"offset\");\n      $(\"#\" + showList[i]).chatbox(\n        \"option\",\n        \"offset\",\n        chatbox_config.offset - diff\n      );\n    }\n  } else {\n    alert(\"NOTE: Id missing from array: \" + id);\n  }\n};\n\n// caller should guarantee the uniqueness of id\nvar addBox = function(id, user, name) {\n  var idx1 = showList.indexOf(id);\n  var idx2 = boxList.indexOf(id);\n  if (idx1 !== -1) {\n    // found one in show box, do nothing\n  } else if (idx2 !== -1) {\n    // exists, but hidden\n    // show it and put it back to showList\n    $(\"#\" + id).chatbox(\"option\", \"offset\", getNextOffset());\n    var manager = $(\"#\" + id).chatbox(\"option\", \"boxManager\");\n    manager.toggleBox();\n    showList.push(id);\n  } else {\n    var el = document.createElement(\"div\");\n    el.setAttribute(\"id\", id);\n    $(el).chatbox({\n      id: id,\n      user: user,\n      title:\n        '<i title=\"' +\n        user.status +\n        '\"></i>' +\n        user.first_name +\n        \" \" +\n        user.last_name,\n      hidden: false,\n      offset: getNextOffset(),\n      width: chatbox_config.width,\n      status: user.status,\n      alertmsg: user.alertmsg,\n      alertshow: user.alertshow,\n      messageSent: dispatch,\n      boxClosed: boxClosedCallback\n    });\n    boxList.push(id);\n    showList.push(id);\n    nameList.push(user.first_name);\n  }\n};\n\n// var messageSentCallback = function (id, user, msg) {\n//   var idx = boxList.indexOf(id);\n//   // chatbox_config.messageSent(nameList[idx], msg);\n// };\n\n// not used in demo\nvar dispatch = function(id, user, msg) {\n  //$(\"#log\").append(\"<i>\" + moment().calendar() + \"</i> you said to <b>\" + user.first_name + \" \" + user.last_name + \":</b> \" + msg + \"<br/>\");\n  if ($(\"#chatlog\").length) {\n    $(\"#chatlog\")\n      .append(\n        \"You said to <b>\" +\n          user.first_name +\n          \" \" +\n          user.last_name +\n          \":</b> \" +\n          msg +\n          \"<br/>\"\n      )\n      .effect(\"highlight\", {}, 500);\n  }\n  $(\"#\" + id)\n    .chatbox(\"option\", \"boxManager\")\n    .addMsg(\"Me\", msg);\n};\n\nexport const ChatBoxes = {\n  init: init,\n  addBox: addBox,\n  delBox: delBox,\n  dispatch: dispatch\n};\n"]},"metadata":{},"sourceType":"module"}