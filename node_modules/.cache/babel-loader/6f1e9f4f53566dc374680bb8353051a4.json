{"ast":null,"code":"/*!\n * Column visibility buttons for Buttons and DataTables.\n * 2016 SpryMedia Ltd - datatables.net/license\n */\n(function (factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD\n    define(['jquery', 'datatables.net', 'datatables.net-buttons'], function ($) {\n      return factory($, window, document);\n    });\n  } else if (typeof exports === 'object') {\n    // CommonJS\n    module.exports = function (root, $) {\n      if (!root) {\n        root = window;\n      }\n\n      if (!$ || !$.fn.dataTable) {\n        $ = require('datatables.net')(root, $).$;\n      }\n\n      if (!$.fn.dataTable.Buttons) {\n        require('datatables.net-buttons')(root, $);\n      }\n\n      return factory($, root, root.document);\n    };\n  } else {\n    // Browser\n    factory(jQuery, window, document);\n  }\n})(function ($, window, document, undefined) {\n  'use strict';\n\n  var DataTable = $.fn.dataTable;\n  $.extend(DataTable.ext.buttons, {\n    // A collection of column visibility buttons\n    colvis: function colvis(dt, conf) {\n      return {\n        extend: 'collection',\n        text: function text(dt) {\n          return dt.i18n('buttons.colvis', 'Column visibility');\n        },\n        className: 'buttons-colvis',\n        buttons: [{\n          extend: 'columnsToggle',\n          columns: conf.columns,\n          columnText: conf.columnText\n        }]\n      };\n    },\n    // Selected columns with individual buttons - toggle column visibility\n    columnsToggle: function columnsToggle(dt, conf) {\n      var columns = dt.columns(conf.columns).indexes().map(function (idx) {\n        return {\n          extend: 'columnToggle',\n          columns: idx,\n          columnText: conf.columnText\n        };\n      }).toArray();\n      return columns;\n    },\n    // Single button to toggle column visibility\n    columnToggle: function columnToggle(dt, conf) {\n      return {\n        extend: 'columnVisibility',\n        columns: conf.columns,\n        columnText: conf.columnText\n      };\n    },\n    // Selected columns with individual buttons - set column visibility\n    columnsVisibility: function columnsVisibility(dt, conf) {\n      var columns = dt.columns(conf.columns).indexes().map(function (idx) {\n        return {\n          extend: 'columnVisibility',\n          columns: idx,\n          visibility: conf.visibility,\n          columnText: conf.columnText\n        };\n      }).toArray();\n      return columns;\n    },\n    // Single button to set column visibility\n    columnVisibility: {\n      columns: undefined,\n      // column selector\n      text: function text(dt, button, conf) {\n        return conf._columnText(dt, conf);\n      },\n      className: 'buttons-columnVisibility',\n      action: function action(e, dt, button, conf) {\n        var col = dt.columns(conf.columns);\n        var curr = col.visible();\n        col.visible(conf.visibility !== undefined ? conf.visibility : !(curr.length ? curr[0] : false));\n      },\n      init: function init(dt, button, conf) {\n        var that = this;\n        button.attr('data-cv-idx', conf.columns);\n        dt.on('column-visibility.dt' + conf.namespace, function (e, settings) {\n          if (!settings.bDestroying && settings.nTable == dt.settings()[0].nTable) {\n            that.active(dt.column(conf.columns).visible());\n          }\n        }).on('column-reorder.dt' + conf.namespace, function (e, settings, details) {\n          if (dt.columns(conf.columns).count() !== 1) {\n            return;\n          } // This button controls the same column index but the text for the column has\n          // changed\n\n\n          button.text(conf._columnText(dt, conf)); // Since its a different column, we need to check its visibility\n\n          that.active(dt.column(conf.columns).visible());\n        });\n        this.active(dt.column(conf.columns).visible());\n      },\n      destroy: function destroy(dt, button, conf) {\n        dt.off('column-visibility.dt' + conf.namespace).off('column-reorder.dt' + conf.namespace);\n      },\n      _columnText: function _columnText(dt, conf) {\n        // Use DataTables' internal data structure until this is presented\n        // is a public API. The other option is to use\n        // `$( column(col).node() ).text()` but the node might not have been\n        // populated when Buttons is constructed.\n        var idx = dt.column(conf.columns).index();\n        var title = dt.settings()[0].aoColumns[idx].sTitle.replace(/\\n/g, \" \") // remove new lines\n        .replace(/<br\\s*\\/?>/gi, \" \") // replace line breaks with spaces\n        .replace(/<select(.*?)<\\/select>/g, \"\") // remove select tags, including options text\n        .replace(/<!\\-\\-.*?\\-\\->/g, \"\") // strip HTML comments\n        .replace(/<.*?>/g, \"\") // strip HTML\n        .replace(/^\\s+|\\s+$/g, \"\"); // trim\n\n        return conf.columnText ? conf.columnText(dt, idx, title) : title;\n      }\n    },\n    colvisRestore: {\n      className: 'buttons-colvisRestore',\n      text: function text(dt) {\n        return dt.i18n('buttons.colvisRestore', 'Restore visibility');\n      },\n      init: function init(dt, button, conf) {\n        conf._visOriginal = dt.columns().indexes().map(function (idx) {\n          return dt.column(idx).visible();\n        }).toArray();\n      },\n      action: function action(e, dt, button, conf) {\n        dt.columns().every(function (i) {\n          // Take into account that ColReorder might have disrupted our\n          // indexes\n          var idx = dt.colReorder && dt.colReorder.transpose ? dt.colReorder.transpose(i, 'toOriginal') : i;\n          this.visible(conf._visOriginal[idx]);\n        });\n      }\n    },\n    colvisGroup: {\n      className: 'buttons-colvisGroup',\n      action: function action(e, dt, button, conf) {\n        dt.columns(conf.show).visible(true, false);\n        dt.columns(conf.hide).visible(false, false);\n        dt.columns.adjust();\n      },\n      show: [],\n      hide: []\n    }\n  });\n  return DataTable.Buttons;\n});","map":null,"metadata":{},"sourceType":"script"}